(this["webpackJsonpgame-in-dots"]=this["webpackJsonpgame-in-dots"]||[]).push([[0],{20:function(e,t,n){e.exports=n(33)},32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(0),i=n.n(o),l=n(7),s=n.n(l),u=n(1),d=n(2),E=n(4),f=n(15),m="https://starnavi-frontend-test-task.herokuapp.com/winners";function p(){return{difficulties:null,currentMode:null,playerName:null,winners:null,score:[0,0],stage:a.SETTING}}!function(e){e.DEFAULT="transparent",e.BLUE="#42d8e8",e.GREEN="#00e871",e.RED="#e85a5e"}(r||(r={})),function(e){e[e.SETTING=0]="SETTING",e[e.PLAYING=1]="PLAYING",e[e.WIN=2]="WIN"}(a||(a={})),function(e){e.SET_DIFFICULTIES="SET_DIFFICULTIES",e.SET_CURRENT_MODE="SET_CURRENT_MODE",e.SET_PLAYER_NAME="SET_PLAYER_NAME",e.SET_WINNERS="SET_WINNERS",e.SET_SCORE="SET_SCORE",e.SET_STAGE="SET_STAGE"}(c||(c={}));var h=Object(E.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.SET_DIFFICULTIES:return Object(d.a)({},e,{difficulties:t.payload});case c.SET_CURRENT_MODE:return Object(d.a)({},e,{currentMode:t.payload});case c.SET_PLAYER_NAME:return Object(d.a)({},e,{playerName:t.payload});case c.SET_WINNERS:return Object(d.a)({},e,{winners:t.payload});case c.SET_SCORE:return Object(d.a)({},e,{score:t.payload});case c.SET_STAGE:return Object(d.a)({},e,{stage:t.payload});default:return e}}),Object(E.c)(Object(E.a)(f.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),S=n(3);var T=function(){var e=Object(u.d)((function(e){return e.difficulties})),t=Object(u.d)((function(e){return e.currentMode})),n=Object(u.d)((function(e){return e.stage})),r=Object(u.c)(),o=["Pick game mode"];return e&&o.push.apply(o,Object(S.a)(Object.keys(e))),i.a.createElement("select",{className:"select",value:t||"Pick game mode",onChange:function(e){var t=e.target.value;r({type:c.SET_CURRENT_MODE,payload:"Pick game mode"===t?null:t})},disabled:n!==a.SETTING},o.map((function(e){return i.a.createElement("option",{key:e,value:e},e)})))};var v=function(){var e,t=Object(u.d)((function(e){return e.currentMode})),n=Object(u.d)((function(e){return e.playerName})),r=Object(u.d)((function(e){return e.stage})),o=Object(u.c)(),l=!n||!t;switch(r){case a.SETTING:e="PLAY";break;case a.PLAYING:case a.WIN:e="PLAY AGAIN";break;default:throw new Error}return i.a.createElement("button",{className:"button",onClick:function(e){switch(r){case a.SETTING:o({type:c.SET_STAGE,payload:a.PLAYING});break;case a.PLAYING:case a.WIN:o({type:c.SET_CURRENT_MODE,payload:null}),o({type:c.SET_SCORE,payload:[0,0]}),o({type:c.SET_STAGE,payload:a.SETTING});break;default:throw new Error}},disabled:l},e)};var N=function(){var e=Object(u.d)((function(e){return e.playerName})),t=Object(u.d)((function(e){return e.stage})),n=Object(u.c)();return i.a.createElement("input",{className:"field",type:"text",value:e||"",placeholder:"Enter your name",onChange:function(e){n({type:c.SET_PLAYER_NAME,payload:e.target.value})},disabled:t!==a.SETTING})},b=n(6);var y=function(){var e,t=Object(u.d)((function(e){return e.currentMode})),n=Object(u.d)((function(e){return e.playerName})),r=Object(u.d)((function(e){return e.stage})),c=Object(u.d)((function(e){return e.score})),o="";switch(r){case a.SETTING:var l=!t,s=!n;l&&(o+="pick game mode"),l&&s&&(o+=" and "),s&&(o+="enter your name"),o||(o+="push PLAY button, and good luck :-)"),o&&(o="Please, ".concat(o)),e=" message--setting";break;case a.PLAYING:var d=Object(b.a)(c,2),E=d[0],f=d[1];o="Score: You ".concat(E," : ").concat(f,' "computer"');break;case a.WIN:var m=Object(b.a)(c,2),p=m[0],h=m[1];o="Game over. \nScore: ".concat(p," : ").concat(h,". ").concat(p>h?"You are win!":"Computer win."," \nPlease, play again :-)");break;default:throw new Error}return o?i.a.createElement("p",{className:"message".concat(e||"")},o):null},O=n(16),w=n(17),g=n(9),I=n(18),_=n(19),j=function(e,t){return fetch.apply(null,arguments).then((function(e){if(e.ok)return e.json();throw new Error("Fetch error with status: ".concat(e.status))})).catch((function(e){return console.error(e)}))};var k=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var o;Object(O.a)(this,n),(o=t.call(this,e)).props=e,o.scoreLocal=void 0,o.timerId=void 0,o.cell=void 0,o.isStarted=void 0,o.grid=void 0,o.coordinates=void 0,o.newGrid=function(e){return new Array(e).fill(null).map((function(t){return new Array(e).fill(r.DEFAULT)}))},o.newCoordinates=function(e){for(var t=[],n=0;n<e;++n)for(var r=0;r<e;++r)t.push([n,r]);return t},o.timer=function(){o.clearTimer(),o.fillSelectedCell(r.RED),o.incrementComputerScore();var e=o.checkWinner();e?(o.sendResultsAndDispatchThem(e),o.dispatchStageWin()):(o.selectRandomCell(),o.fillSelectedCell(r.BLUE),o.startTimer()),o.dispatchScore()},o.onClick=function(e){o.clearTimer(),o.fillSelectedCell(r.GREEN),o.incrementPlayerScore();var t=o.checkWinner();t?(o.sendResultsAndDispatchThem(t),o.dispatchStageWin()):(o.selectRandomCell(),o.fillSelectedCell(r.BLUE),o.startTimer()),o.dispatchScore()},o.startTimer=function(){var e=o.props.store,t=e.difficulties[e.currentMode].delay;t&&("number"===typeof o.timerId&&(console.error(new Error),o.clearTimer()),o.timerId=window.setTimeout(o.timer,t))},o.clearTimer=function(){if("number"===typeof o.timerId)return window.clearTimeout(o.timerId),void(o.timerId=null)},o.selectRandomCell=function(){o.coordinates.length||(o.cell=null);var e,t,n=(e=0,t=o.coordinates.length,Math.floor(Math.random()*(t-e))+e);o.cell=o.coordinates[n],o.coordinates.splice(n,1)},o.fillSelectedCell=function(e){if(o.cell){var t=Object(b.a)(o.cell,2),n=t[0],r=t[1];o.grid[n][r]=e}},o.incrementPlayerScore=function(){++o.scoreLocal[0]},o.incrementComputerScore=function(){++o.scoreLocal[1]},o.dispatchScore=function(){o.props.dispatch({type:c.SET_SCORE,payload:Object(S.a)(o.scoreLocal)})},o.checkWinner=function(){var e=o.props.store,t=e.difficulties,n=e.currentMode,r=e.playerName,c=e.stage,i=t[n].field;if(c===a.WIN)return null;for(var l=Object(g.a)(o).scoreLocal,s=0,u=l.length;s<u;++s){if(l[s]/Math.pow(i,2)*100>50){var d={date:(new Date).toLocaleString()};switch(s){case 0:d.winner=r||"";break;case 1:d.winner="computer";break;default:throw new Error}return d}}return null},o.sendResultsAndDispatchThem=function(e){o.props.dispatch((function(t,n){var r={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)};j(m,r).then((function(e){return t({type:c.SET_WINNERS,payload:e})}))}))},o.dispatchStageWin=function(){o.props.dispatch({type:c.SET_STAGE,payload:a.WIN})};var i=o.props.store,l=i.difficulties[i.currentMode].field;return o.timerId=null,o.cell=[0,0],o.scoreLocal=[0,0],o.isStarted=!1,o.grid=o.newGrid(l),o.coordinates=o.newCoordinates(l),o}return Object(w.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=e.store,n=t.difficulties[t.currentMode].field;n===this.props.store.difficulties[this.props.store.currentMode].field||(this.grid=this.newGrid(n),this.coordinates=this.newCoordinates(n));var c=e.store.stage;return this.isStarted||c!==a.PLAYING||(this.selectRandomCell(),this.fillSelectedCell(r.BLUE),this.startTimer(),this.isStarted=!0),!0}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"render",value:function(){var e=this,t=this.props.store,n=t.difficulties[t.currentMode].field,a="".concat(100/n,"%");return i.a.createElement("div",{className:"grid"},this.grid.map((function(t,n){return i.a.createElement("div",{key:n,className:"container",style:{height:a,width:"100%",border:"solid whitesmoke 1px"}},t.map((function(t,n){return i.a.createElement("div",{key:n,onClick:t===r.BLUE?e.onClick:null,style:{height:"100%",width:a,backgroundColor:t,border:"solid whitesmoke 1px"}})})))})))}}]),n}(i.a.Component),C=Object(u.b)((function(e){return{store:e}}),(function(e){return{dispatch:e}}))(k);var R=function(){var e=Object(u.d)((function(e){return e.winners}));return i.a.createElement("div",{className:"container winners"},i.a.createElement("h3",null,"Leader Board"),e&&i.a.createElement("ul",{className:"stretch"},Object(S.a)(e).reverse().map((function(e,t,n){var r=e.winner,a=e.date;return i.a.createElement("li",{key:t,className:"container"},i.a.createElement("span",null,r),i.a.createElement("span",null,a))}))))};var L=function(){var e=Object(u.d)((function(e){return e.difficulties})),t=Object(u.d)((function(e){return e.currentMode})),n=Object(u.c)();return Object(o.useEffect)((function(){n((function(e,t){j("https://starnavi-frontend-test-task.herokuapp.com/game-settings").then((function(t){return e({type:c.SET_DIFFICULTIES,payload:t})})),j(m).then((function(t){return e({type:c.SET_WINNERS,payload:t})}))}))}),[]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"container game"},i.a.createElement("div",{className:"container controls"},i.a.createElement(T,null),i.a.createElement(N,null),i.a.createElement(v,null)),i.a.createElement(y,null),e&&t&&i.a.createElement(C,null)),i.a.createElement("div",{className:"container results"},i.a.createElement(R,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(31),n(32);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(u.a,{store:h},i.a.createElement(L,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.88daf2ae.chunk.js.map